# AI 辩论练习 — 产品需求文档（PRD）

> 版本：v1.0  
> 日期：2026-02-07  
> 状态：草案

---

## 目录

1. [产品概述](#1-产品概述)
2. [目标用户与使用场景](#2-目标用户与使用场景)
3. [产品架构总览](#3-产品架构总览)
4. [核心功能需求](#4-核心功能需求)
5. [辩论赛流程设计](#5-辩论赛流程设计)
6. [AI 模型方案](#6-ai-模型方案)
7. [语音交互设计](#7-语音交互设计)
8. [评分系统设计](#8-评分系统设计)
9. [页面与交互设计](#9-页面与交互设计)
10. [技术方案](#10-技术方案)
11. [非功能性需求](#11-非功能性需求)
12. [开发里程碑](#12-开发里程碑)
13. [风险与应对](#13-风险与应对)
14. [附录](#14-附录)
15. [交互与视觉升级规范](#15-交互与视觉升级规范)
16. [性能测试与兼容性报告](#16-性能测试与兼容性报告)
17. [演示与交付物说明](#17-演示与交付物说明)

---

## 1. 产品概述

### 1.1 产品名称

**AI 辩论练习**（AI Debate Arena）

### 1.2 产品定位

一款面向辩论爱好者、学生和演讲训练者的 Web 端 AI 辩论练习工具。用户可以与 AI 辩手进行一场完整流程的辩论赛，辩论结束后由独立的 AI 裁判进行全面评分和点评，帮助用户提升辩论能力和逻辑思维。

### 1.3 核心价值主张

| 价值点 | 说明 |
|--------|------|
| **随时练习** | 无需组队、无需约时间，随时可以与 AI 进行一场高质量辩论 |
| **语音优先** | 还原真实辩论场景，支持语音输入/输出，沉浸式体验 |
| **公正评判** | 辩论 AI 与评判 AI 使用不同大模型，确保独立性和公平性 |
| **专业反馈** | 赛后获得多维度详细评分和改进建议 |
| **循序渐进** | 支持多难度等级，从新手到高手逐步提升 |

### 1.4 产品愿景

成为中文辩论练习的首选 AI 工具，让每一个辩论爱好者都能拥有一位 24 小时在线的高质量辩论陪练。

---

## 2. 目标用户与使用场景

### 2.1 目标用户画像

| 用户类型 | 描述 | 核心需求 |
|----------|------|----------|
| **辩论队成员** | 大学/高中辩论队队员，需要日常训练 | 高频次练习、专业评价、技巧提升 |
| **演讲培训学员** | 正在学习演讲与口才的学员 | 逻辑训练、语言表达、即兴应变 |
| **辩论爱好者** | 对辩论感兴趣的普通用户 | 趣味体验、知识拓展、自我挑战 |
| **教师/教练** | 辩论课教师或辩论队教练 | 作为教学工具，让学生课后自主练习 |
| **考试备考者** | 考研复试/公务员面试/MBA面试等需要辩证思维的备考者 | 结构化表达、逻辑论证能力 |

### 2.2 典型使用场景

1. **赛前训练**：辩论队比赛前，队员针对比赛辩题与 AI 进行模拟练习
2. **日常练习**：辩论爱好者利用碎片时间随时进行一场辩论
3. **课堂作业**：教师布置辩论练习任务，学生在平台上完成并提交评分报告
4. **自我提升**：用户选择感兴趣的话题，锻炼逻辑思维和表达能力

---

## 3. 产品架构总览

```
┌─────────────────────────────────────────────────────────┐
│                    前端 (Web 应用)                        │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌─────────┐ │
│  │ 辩题选择  │  │ 辩论主界面│  │ 语音交互  │  │评分报告  │ │
│  └──────────┘  └──────────┘  └──────────┘  └─────────┘ │
└───────────────────────┬─────────────────────────────────┘
                        │ WebSocket / HTTP API
┌───────────────────────┴─────────────────────────────────┐
│                   后端服务 (Node.js)                      │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌─────────┐ │
│  │ 辩论引擎  │  │ 计时系统  │  │ 会话管理  │  │评分引擎  │ │
│  └─────┬────┘  └──────────┘  └──────────┘  └────┬────┘ │
│        │                                         │      │
│  ┌─────┴────────────┐          ┌────────────────┴───┐  │
│  │ AI 辩手模型 (A)   │          │ AI 裁判模型 (B)    │  │
│  │ (豆包 Doubao)     │          │ (DeepSeek)         │  │
│  └──────────────────┘          └────────────────────┘  │
│                                                         │
│  ┌──────────────────────────────────────────────────┐  │
│  │           语音服务 (STT + TTS)                     │  │
│  │  语音识别 (Whisper/Azure)  │  语音合成 (Azure/Edge)│  │
│  └──────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
                        │
              ┌─────────┴─────────┐
              │    数据库/存储      │
              │  (辩论记录/用户)    │
              └───────────────────┘
```

---

## 4. 核心功能需求

### 4.1 功能清单总表

| 编号 | 功能模块 | 优先级 | 描述 |
|------|----------|--------|------|
| F01 | 辩题系统 | P0 | 辩题库、随机抽题、自定义辩题、正反方选择 |
| F02 | 辩论引擎 | P0 | 完整辩论流程控制、环节管理、计时系统 |
| F03 | AI 辩手 | P0 | AI 对手的辩论能力，含论点生成、反驳、总结 |
| F04 | 语音交互 | P0 | 语音输入（STT）+ AI 语音输出（TTS） |
| F05 | 文字交互 | P1 | 文字输入作为语音的备选方案 |
| F06 | 计时系统 | P0 | 每个环节的倒计时、超时提醒、自动切换 |
| F07 | AI 裁判评分 | P0 | 独立 AI 模型进行多维度评分和点评 |
| F08 | 评分报告 | P0 | 可视化评分报告、详细点评、改进建议 |
| F09 | 辩论记录 | P1 | 完整辩论文字记录、历史记录查看 |
| F10 | 难度选择 | P1 | AI 辩手难度等级调节 |
| F11 | 用户系统 | P2 | 注册/登录、个人中心、练习统计 |
| F12 | 辩论回放 | P2 | 回放历史辩论（文字/语音） |

### 4.2 功能详细描述

#### F01 辩题系统

**需求描述**：提供丰富的辩题库，支持用户选择或自定义辩题。

**功能点**：

- **辩题库**：
  - 预置 100+ 经典辩题，涵盖社会、科技、教育、伦理、文化等分类
  - 辩题格式：正方立场 vs 反方立场（如："科技发展利大于弊 vs 科技发展弊大于利"）
  - 每个辩题附带背景资料和关键论点提示（可选择是否查看）
  
- **辩题选择方式**：
  - 按分类浏览选择
  - 随机抽题（可限定分类）
  - 关键词搜索
  - 热门/推荐辩题
  
- **自定义辩题**：
  - 用户可输入自定义辩题
  - AI 自动解析并生成正反方立场
  - 输入校验：确保辩题具有可辩论性

- **立场选择**：
  - 用户选择正方或反方
  - 支持随机分配立场
  - AI 自动适配对应立场

#### F02 辩论引擎

**需求描述**：控制完整辩论流程，管理各环节的节奏和规则。

**功能点**：

- 支持标准辩论赛制（详见第 5 节）
- 环节自动推进与手动控制
- 实时状态管理（当前环节、当前发言方、剩余时间）
- 异常处理（用户中途退出、网络中断等）
- 辩论暂停/继续功能

#### F03 AI 辩手

**需求描述**：AI 作为用户的辩论对手，提供高质量的辩论内容。

**功能点**：

- **论点生成**：基于辩题和立场生成有逻辑的论点
- **反驳能力**：针对用户的论点进行有效反驳
- **引用论据**：引用事实、数据、案例来支持论点
- **策略调整**：根据辩论进程调整策略
- **难度等级**：
  - 🟢 入门级：论点简单，语速较慢，给用户更多思考空间
  - 🟡 进阶级：论点有深度，适度反驳，模拟普通辩手
  - 🔴 专家级：论点犀利，反驳迅速，模拟专业辩手
- **风格设定**：可选择 AI 的辩论风格（理性型/激情型/学术型）
- **上下文记忆**：AI 能记住整场辩论的所有内容，保持论点一致性

#### F04 语音交互（核心功能）

**需求描述**：提供语音优先的交互方式，还原真实辩论场景。

**功能点**：

- **语音输入（Speech-to-Text）**：
  - 实时语音识别，支持中文普通话
  - 实时显示识别文字（边说边显示）
  - 支持长段语音识别（辩论环节可能持续 2-3 分钟）
  - 语音端点检测（用户停止说话后自动结束）
  - 识别准确率要求 ≥ 95%
  
- **语音输出（Text-to-Speech）**：
  - AI 辩手的回复通过语音播放
  - 自然流畅的中文语音合成
  - 可选择 AI 的声音类型（男声/女声）
  - 支持流式语音合成（AI 生成文字后立即开始播放，不用等全部生成完）
  - 语速可调节

- **语音控制**：
  - 按键说话模式（Push-to-Talk）
  - 自由说话模式（Voice Activity Detection，检测到说话自动录音）
  - 用户可随时中断 AI 的语音播放（模拟辩论中的"打断"）

#### F05 文字交互

**需求描述**：作为语音的备选输入方式。

**功能点**：

- 文字输入框，支持中文输入
- 输入时显示剩余时间
- 支持快捷键发送（Enter 发送）
- 文字输入与语音输入可自由切换
- 实时字数统计

#### F06 计时系统

**需求描述**：每个辩论环节都有时间限制，模拟真实辩论赛。

**功能点**：

- 每个环节独立计时
- 倒计时可视化显示（大字体）
- 时间预警：
  - 剩余 30 秒：黄色提醒 + 提示音
  - 剩余 10 秒：红色提醒 + 提示音
  - 时间到：强制结束当前发言 + 结束音效
- AI 发言也受时间限制
- 准备时间计时（部分环节有准备时间）
- 总用时统计

#### F07 AI 裁判评分

**需求描述**：使用与辩论 AI 不同的大模型，对整场辩论进行独立评判。

**功能点**：

- 收集整场辩论的完整文字记录
- 调用独立的 AI 模型（与辩论 AI 不同）进行评分
- 多维度评分体系（详见第 8 节）
- 给出详细的文字点评
- 判定胜负并说明理由
- 针对用户给出具体改进建议

#### F08 评分报告

**需求描述**：以直观的方式展示评分结果。

**功能点**：

- **总分展示**：用户得分 vs AI 得分
- **维度得分**：雷达图展示各维度得分对比
- **胜负判定**：明确标注谁赢了本场辩论
- **文字点评**：
  - 对用户表现的总体评价
  - 各环节的具体点评
  - 精彩之处的肯定
  - 不足之处的指出
- **改进建议**：针对性的提升建议
- **关键时刻回顾**：标注辩论中的关键转折点
- **导出功能**：支持导出评分报告为 PDF
- **分享功能**：生成分享链接/图片

#### F09 辩论记录

- 完整的辩论文字稿（含时间戳）
- 用户和 AI 的发言分段展示
- 支持按环节查看
- 历史辩论记录列表

#### F10 难度选择

- 三个难度等级（入门/进阶/专家）
- 难度影响 AI 的论点深度、反驳速度、论证严密程度
- 入门模式下 AI 会适当"放水"，让用户有更好的体验
- 专家模式下 AI 会使用高级辩论技巧

---

## 5. 辩论赛流程设计

### 5.1 采用赛制：简化标准赛制

考虑到是单人对 AI 的练习场景，采用简化的 1v1 辩论赛制：

```
┌─────────────────────────────────────────────────┐
│              AI 辩论练习 — 赛制流程               │
├─────────────────────────────────────────────────┤
│                                                  │
│  📋 赛前准备                                      │
│  ├─ 选择辩题 & 立场                               │
│  ├─ 选择难度                                      │
│  └─ 赛前准备时间（3 分钟，可跳过）                  │
│                                                  │
│  🎤 第一环节：开篇立论                              │
│  ├─ 正方立论（3 分钟）                             │
│  └─ 反方立论（3 分钟）                             │
│                                                  │
│  ⚔️ 第二环节：攻辩（质询）                          │
│  ├─ 正方质询反方（2 分钟，一问一答）                 │
│  └─ 反方质询正方（2 分钟，一问一答）                 │
│                                                  │
│  🔥 第三环节：自由辩论                              │
│  ├─ 双方交替发言                                   │
│  ├─ 每方总计 3 分钟                                │
│  └─ 一方发言结束后，另一方立即开始                   │
│                                                  │
│  📝 第四环节：总结陈词                              │
│  ├─ 反方总结（2 分钟）                             │
│  └─ 正方总结（2 分钟）                             │
│                                                  │
│  ⚖️ 赛后评判                                      │
│  ├─ AI 裁判分析整场辩论                            │
│  ├─ 多维度评分                                     │
│  └─ 生成评分报告                                   │
│                                                  │
└─────────────────────────────────────────────────┘
```

### 5.2 环节详细规则

| 环节 | 发言方 | 时间限制 | 规则说明 |
|------|--------|----------|----------|
| 开篇立论（正方） | 正方先发言 | 3 分钟 | 阐述本方基本立场和主要论点 |
| 开篇立论（反方） | 反方发言 | 3 分钟 | 阐述本方基本立场和主要论点 |
| 攻辩·正方质询 | 正方提问，反方回答 | 2 分钟 | 正方向反方提出问题，反方必须正面回答 |
| 攻辩·反方质询 | 反方提问，正方回答 | 2 分钟 | 反方向正方提出问题，正方必须正面回答 |
| 自由辩论 | 双方交替 | 每方各 3 分钟 | 双方交替发言，一方发言时间用尽后由对方继续 |
| 总结陈词（反方） | 反方先总结 | 2 分钟 | 总结本方论点，反驳对方论点 |
| 总结陈词（正方） | 正方后总结 | 2 分钟 | 总结本方论点，进行最终陈述 |

### 5.3 计时规则

- 用户发言环节：计时从用户开始说话时启动（或从用户点击"开始"按钮时启动）
- AI 发言环节：计时从 AI 开始输出时启动
- 超时处理：
  - 用户超时：给予 5 秒缓冲后强制结束，麦克风关闭
  - AI 超时：AI 收到提示后在当前句子说完即停止
- 准备时间：每个环节开始前有 15 秒准备时间（可设置跳过）

### 5.4 赛制可配置项

用户可在开始辩论前调整以下参数：

| 配置项 | 默认值 | 可选范围 | 说明 |
|--------|--------|----------|------|
| 开篇立论时间 | 3 分钟 | 1-5 分钟 | 双方立论的时间 |
| 质询时间 | 2 分钟 | 1-3 分钟 | 每轮质询的时间 |
| 自由辩论时间 | 3 分钟/方 | 2-5 分钟 | 自由辩论每方的时间 |
| 总结陈词时间 | 2 分钟 | 1-3 分钟 | 总结陈词的时间 |
| 准备时间 | 15 秒 | 0-60 秒 | 每环节前的准备时间 |
| 是否启用赛前准备 | 是 | 是/否 | 3分钟赛前准备 |

---

## 6. AI 模型方案

### 6.1 双模型架构

为保证公平性和独立性，采用两个不同的大语言模型：

| 角色 | 推荐模型 | 备选模型 | 职责 |
|------|----------|----------|------|
| **AI 辩手** | 豆包（Doubao） | 文心一言 4.0 / 通义千问 Max | 与用户进行辩论，生成论点和反驳 |
| **AI 裁判** | DeepSeek-V3 | DeepSeek Chat / DeepSeek-R1 | 独立评判辩论，进行评分和点评 |

### 6.2 AI 辩手 Prompt 设计要点

```
角色设定：
- 你是一位经验丰富的辩论选手
- 你的立场是 [正方/反方]：[具体立场]
- 辩题是：[辩题内容]
- 难度等级：[入门/进阶/专家]

行为规范：
- 始终坚守本方立场，不得动摇
- 使用逻辑严密的论证方式
- 引用事实、数据和案例来支持论点
- 针对对方论点进行有效反驳
- 控制发言篇幅，与时间限制匹配
- 保持辩论的礼貌和专业性
- 记住之前所有的发言内容，保持论点一致

当前环节：[环节名称]
环节规则：[具体规则]
已有辩论记录：[之前的所有发言]
```

### 6.3 AI 裁判 Prompt 设计要点

```
角色设定：
- 你是一位公正专业的辩论赛裁判
- 你需要根据完整的辩论记录进行评判
- 你必须保持中立客观

输入信息：
- 辩题：[辩题]
- 正方立场：[立场]（由 [用户/AI] 担任）
- 反方立场：[立场]（由 [AI/用户] 担任）
- 完整辩论记录：[所有环节的发言记录]

评判要求：
- 从多个维度进行评分（满分 100 分）
- 给出详细的文字点评
- 指出双方的优势和不足
- 判定本场辩论的胜负
- 对用户给出针对性的改进建议
```

### 6.4 模型调用策略

- **AI 辩手**：
  - 使用流式输出（Streaming），实现边生成边展示/播放
  - 每次调用携带完整辩论历史（上下文）
  - 设置合理的 max_tokens 以匹配环节时间限制
  - temperature 设为 0.7-0.8，兼顾创造性和逻辑性

- **AI 裁判**：
  - 辩论结束后一次性调用
  - 输入完整辩论记录
  - 要求结构化输出（JSON 格式的评分数据 + 文字点评）
  - temperature 设为 0.3-0.5，偏向稳定和客观

---

## 7. 语音交互设计

### 7.1 语音识别（STT）方案

| 方案 | 优势 | 劣势 | 推荐度 |
|------|------|------|--------|
| **Web Speech API** | 浏览器原生支持，免费 | 依赖 Google 服务，中文效果一般，兼容性有限 | ⭐⭐ |
| **Azure Speech Service** | 中文识别优秀，支持实时流式识别 | 需付费 | ⭐⭐⭐⭐⭐ |
| **OpenAI Whisper API** | 识别质量高 | 不支持实时流式，有延迟 | ⭐⭐⭐ |
| **讯飞语音识别** | 中文识别顶级 | 需付费，SDK 集成 | ⭐⭐⭐⭐ |
| **Deepgram** | 实时流式，延迟低 | 中文支持一般 | ⭐⭐⭐ |

**推荐方案**：Azure Speech Service（主） + Web Speech API（降级备选）

### 7.2 语音合成（TTS）方案

| 方案 | 优势 | 劣势 | 推荐度 |
|------|------|------|--------|
| **Azure TTS** | 中文语音自然度高，支持情感/语调调节 | 需付费 | ⭐⭐⭐⭐⭐ |
| **Edge TTS** | 免费，质量不错 | 非官方 API，稳定性一般 | ⭐⭐⭐⭐ |
| **Web Speech API** | 免费，浏览器原生 | 语音质量一般，机械感明显 | ⭐⭐ |
| **OpenAI TTS** | 语音自然 | 中文支持一般，延迟较高 | ⭐⭐⭐ |

**推荐方案**：Azure TTS（主） + Edge TTS（备选/降低成本）

### 7.3 语音交互流程

```
用户发言流程：
┌──────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐
│ 用户  │───→│ 麦克风录音│───→│ 实时 STT  │───→│ 文字展示  │
│ 说话  │    │          │    │ (流式)    │    │ (实时)   │
└──────┘    └──────────┘    └──────────┘    └──────────┘

AI 发言流程：
┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────┐
│ LLM 生成  │───→│  TTS 合成 │───→│ 音频播放  │───→│ 文字  │
│ (流式)    │    │  (流式)   │    │ (流式)    │    │ 同步  │
└──────────┘    └──────────┘    └──────────┘    └──────┘
```

### 7.4 延迟优化目标

| 指标 | 目标值 | 说明 |
|------|--------|------|
| STT 延迟 | < 500ms | 用户说话到文字显示的延迟 |
| LLM 首字延迟 | < 2s | AI 收到输入到开始生成的延迟 |
| TTS 首音延迟 | < 1s | 文字生成到开始播放的延迟 |
| 端到端延迟 | < 3s | 用户说完到 AI 开始回复的总延迟 |

---

## 8. 评分系统设计

### 8.1 评分维度

| 维度 | 权重 | 满分 | 评判标准 |
|------|------|------|----------|
| **论点质量** | 25% | 25 分 | 论点是否清晰、有力、有说服力 |
| **逻辑严密性** | 25% | 25 分 | 论证过程是否有逻辑，是否存在逻辑谬误 |
| **反驳能力** | 20% | 20 分 | 是否有效回应和反驳对方论点 |
| **论据支撑** | 15% | 15 分 | 是否使用了有效的事实、数据、案例来支撑论点 |
| **表达与风度** | 15% | 15 分 | 语言表达是否流畅、有感染力，是否保持辩论风度 |
| **总分** | 100% | 100 分 | — |

### 8.2 各环节加分项

| 环节 | 加分项 |
|------|--------|
| 开篇立论 | 立论框架清晰、论点层次分明、开篇引人入胜 |
| 攻辩质询 | 提问犀利切中要害、回答正面不回避 |
| 自由辩论 | 反应迅速、攻守兼备、抓住对方漏洞 |
| 总结陈词 | 总结全面、升华主题、收束有力 |

### 8.3 评分输出格式（AI 裁判返回）

```json
{
  "winner": "正方/反方",
  "scores": {
    "user": {
      "total": 82,
      "dimensions": {
        "argument_quality": 20,
        "logic": 22,
        "rebuttal": 16,
        "evidence": 12,
        "expression": 12
      }
    },
    "ai": {
      "total": 78,
      "dimensions": {
        "argument_quality": 19,
        "logic": 20,
        "rebuttal": 15,
        "evidence": 13,
        "expression": 11
      }
    }
  },
  "overall_comment": "本场辩论整体水平较高...",
  "user_highlights": ["在自由辩论环节敏锐地抓住了对方的逻辑漏洞..."],
  "user_improvements": ["在开篇立论部分可以更加注重论点的层次性..."],
  "stage_comments": {
    "opening": "正方开篇立论结构清晰...",
    "cross_examination": "质询环节双方表现均可...",
    "free_debate": "自由辩论环节是本场辩论的亮点...",
    "closing": "总结陈词环节..."
  },
  "key_moments": [
    {
      "stage": "自由辩论",
      "description": "用户提出了一个关键反问...",
      "impact": "正面"
    }
  ]
}
```

---

## 9. 页面与交互设计

### 9.1 页面结构

| 页面 | 路由 | 说明 |
|------|------|------|
| 首页 | `/` | 产品介绍、开始辩论入口 |
| 辩题选择页 | `/topic` | 选择/自定义辩题，选择立场和难度 |
| 辩论主界面 | `/debate` | 辩论进行的主要页面 |
| 评分报告页 | `/report/:id` | 展示辩论评分报告 |
| 历史记录页 | `/history` | 查看历史辩论记录 |
| 设置页 | `/settings` | 语音设置、偏好配置 |

### 9.2 辩论主界面布局设计

```
┌────────────────────────────────────────────────────┐
│  🔴  当前环节：自由辩论    ⏱️ 剩余时间：02:15       │
│  进度条: ████████░░░░░░░░  (环节 5/7)              │
├────────────────────────────────────────────────────┤
│                                                    │
│  ┌──────────────┐          ┌──────────────┐       │
│  │   👤 用户     │          │   🤖 AI 辩手  │       │
│  │   正方        │    VS    │   反方        │       │
│  │   得分预估    │          │   得分预估     │       │
│  └──────────────┘          └──────────────┘       │
│                                                    │
│  ┌────────────────────────────────────────────┐   │
│  │              辩论对话区域                     │   │
│  │                                             │   │
│  │  [用户] 我方认为科技发展利大于弊，理由有     │   │
│  │  三点。第一...                               │   │
│  │                                             │   │
│  │  [AI] 对方辩友的论点存在明显漏洞。首先...    │   │
│  │                                             │   │
│  │  [用户] 对方辩友偷换了概念...                 │   │
│  │                                             │   │
│  │  ▎正在录音中... 🎙️                          │   │
│  │  "我认为这个观点是站不住脚的，因为..."       │   │
│  │  (实时语音识别文字)                          │   │
│  │                                             │   │
│  └────────────────────────────────────────────┘   │
│                                                    │
│  ┌────────────────────────────────────────────┐   │
│  │  🎙️ [按住说话]    📝 [切换文字输入]           │   │
│  │                                             │   │
│  │  ⏸️ 暂停  │  ⏹️ 结束发言  │  ⚙️ 设置        │   │
│  └────────────────────────────────────────────┘   │
└────────────────────────────────────────────────────┘
```

### 9.3 评分报告页布局

```
┌────────────────────────────────────────────────────┐
│           ⚖️ 辩论评分报告                           │
│     辩题：科技发展利大于弊 vs 弊大于利               │
├────────────────────────────────────────────────────┤
│                                                    │
│    🏆 本场胜者：正方（用户）                         │
│                                                    │
│    ┌──────────────────────────────────┐            │
│    │     用户：82 分  vs  AI：78 分    │            │
│    │     [===========82===========]   │            │
│    │     [==========78==========]     │            │
│    └──────────────────────────────────┘            │
│                                                    │
│    📊 维度对比雷达图                                │
│    ┌──────────────────────────────────┐            │
│    │         论点质量                  │            │
│    │           /\                     │            │
│    │     表达 /  \ 逻辑               │            │
│    │         /    \                   │            │
│    │    论据 \    / 反驳               │            │
│    │         \  /                     │            │
│    │          \/                      │            │
│    │    🔵 用户  🔴 AI                │            │
│    └──────────────────────────────────┘            │
│                                                    │
│    📝 裁判点评                                      │
│    ┌──────────────────────────────────┐            │
│    │ 总体评价：本场辩论...             │            │
│    │ 亮点：...                        │            │
│    │ 待提升：...                      │            │
│    │ 环节点评：...                     │            │
│    │ 改进建议：...                     │            │
│    └──────────────────────────────────┘            │
│                                                    │
│    [📄 导出PDF]  [🔗 分享]  [🔄 再来一场]           │
│                                                    │
└────────────────────────────────────────────────────┘
```

### 9.4 UI 设计规范

| 设计要素 | 规范 |
|----------|------|
| 设计风格 | 现代简约，专业感，深色/浅色主题可切换 |
| 主色调 | 深蓝 #1a237e（专业）+ 金色 #ffd700（辩论荣誉感）|
| 字体 | 中文：思源黑体/Noto Sans SC，英文：Inter |
| 动画 | 环节切换使用平滑过渡动画，计时器使用动态效果 |
| 响应式 | 优先适配桌面端（1280px+），兼容平板（768px+） |
| 可访问性 | 符合 WCAG 2.1 AA 标准 |

---

## 10. 技术方案

### 10.1 技术栈

| 层级 | 技术选型 | 说明 |
|------|----------|------|
| **前端框架** | React 18 + TypeScript | 组件化开发，类型安全 |
| **UI 框架** | Tailwind CSS + Shadcn/UI | 快速开发，现代美观 |
| **状态管理** | Zustand | 轻量灵活，适合中型应用 |
| **构建工具** | Vite | 快速开发体验 |
| **后端框架** | Node.js + Express / Fastify | 轻量高效 |
| **实时通信** | WebSocket (Socket.IO) | 实时辩论交互 |
| **AI 辩手** | 豆包 API (Doubao API) | 辩论对话生成 |
| **AI 裁判** | DeepSeek API | 独立评判 |
| **语音识别** | Azure Speech SDK / Web Speech API | STT |
| **语音合成** | Azure TTS / Edge TTS | TTS |
| **数据库** | SQLite / PostgreSQL | 存储辩论记录和用户数据 |
| **部署** | Vercel (前端) + Railway/Fly.io (后端) | 快速部署 |

### 10.2 前端核心模块

```
src/
├── components/
│   ├── debate/
│   │   ├── DebateArena.tsx        # 辩论主界面
│   │   ├── DebateTimer.tsx        # 计时器组件
│   │   ├── DebateStageBar.tsx     # 环节进度条
│   │   ├── MessageBubble.tsx      # 发言气泡
│   │   ├── VoiceRecorder.tsx      # 语音录制组件
│   │   ├── AudioPlayer.tsx        # AI 语音播放
│   │   └── TextInput.tsx          # 文字输入
│   ├── topic/
│   │   ├── TopicSelector.tsx      # 辩题选择
│   │   ├── TopicCard.tsx          # 辩题卡片
│   │   └── StanceSelector.tsx     # 立场选择
│   ├── report/
│   │   ├── ScoreReport.tsx        # 评分报告
│   │   ├── RadarChart.tsx         # 雷达图
│   │   ├── ScoreBar.tsx           # 分数条
│   │   └── JudgeComment.tsx       # 裁判点评
│   └── common/
│       ├── Header.tsx             # 顶部导航
│       ├── ThemeToggle.tsx        # 主题切换
│       └── Loading.tsx            # 加载状态
├── hooks/
│   ├── useDebateEngine.ts         # 辩论引擎 Hook
│   ├── useTimer.ts                # 计时器 Hook
│   ├── useSpeechRecognition.ts    # 语音识别 Hook
│   ├── useSpeechSynthesis.ts      # 语音合成 Hook
│   └── useWebSocket.ts            # WebSocket Hook
├── store/
│   ├── debateStore.ts             # 辩论状态
│   └── settingsStore.ts          # 设置状态
├── services/
│   ├── debateService.ts           # 辩论 API
│   ├── speechService.ts          # 语音服务
│   └── reportService.ts          # 报告 API
├── types/
│   └── debate.ts                  # TypeScript 类型定义
├── utils/
│   ├── debateRules.ts             # 辩论规则配置
│   └── formatters.ts             # 格式化工具
└── pages/
    ├── HomePage.tsx
    ├── TopicPage.tsx
    ├── DebatePage.tsx
    ├── ReportPage.tsx
    └── HistoryPage.tsx
```

### 10.3 后端核心模块

```
server/
├── routes/
│   ├── debate.ts                  # 辩论相关 API
│   ├── topic.ts                   # 辩题 API
│   ├── report.ts                  # 报告 API
│   └── speech.ts                  # 语音代理 API
├── services/
│   ├── debateEngine.ts            # 辩论引擎
│   ├── aiDebater.ts               # AI 辩手服务
│   ├── aiJudge.ts                 # AI 裁判服务
│   ├── speechToText.ts            # 语音识别服务
│   ├── textToSpeech.ts            # 语音合成服务
│   └── timerService.ts            # 计时服务
├── models/
│   ├── debate.ts                  # 辩论数据模型
│   ├── topic.ts                   # 辩题数据模型
│   └── user.ts                    # 用户数据模型
├── websocket/
│   └── debateSocket.ts            # WebSocket 辩论通信
├── prompts/
│   ├── debaterPrompt.ts           # AI 辩手 Prompt 模板
│   └── judgePrompt.ts            # AI 裁判 Prompt 模板
├── config/
│   └── index.ts                   # 配置管理
└── app.ts                         # 应用入口
```

### 10.4 核心 API 设计

#### REST API

| 方法 | 路径 | 说明 |
|------|------|------|
| GET | `/api/topics` | 获取辩题列表 |
| GET | `/api/topics/:id` | 获取辩题详情 |
| POST | `/api/topics/custom` | 创建自定义辩题 |
| POST | `/api/debate/create` | 创建辩论会话 |
| GET | `/api/debate/:id` | 获取辩论详情 |
| POST | `/api/debate/:id/end` | 结束辩论 |
| GET | `/api/report/:debateId` | 获取评分报告 |
| GET | `/api/history` | 获取历史记录 |
| POST | `/api/speech/tts` | 文字转语音 |

#### WebSocket 事件

| 事件名 | 方向 | 数据 | 说明 |
|--------|------|------|------|
| `debate:start` | Client→Server | `{debateId, config}` | 开始辩论 |
| `debate:stage_change` | Server→Client | `{stage, speaker, timeLimit}` | 环节切换 |
| `user:speech_text` | Client→Server | `{text, isFinal}` | 用户语音识别文字 |
| `user:text_input` | Client→Server | `{text}` | 用户文字输入 |
| `user:end_turn` | Client→Server | `{}` | 用户结束发言 |
| `ai:response_start` | Server→Client | `{}` | AI 开始回复 |
| `ai:response_chunk` | Server→Client | `{text, audio}` | AI 回复片段（文字+音频流） |
| `ai:response_end` | Server→Client | `{}` | AI 回复结束 |
| `timer:tick` | Server→Client | `{remaining, stage}` | 计时更新 |
| `timer:warning` | Server→Client | `{type: '30s'/'10s'/'timeout'}` | 时间警告 |
| `debate:end` | Server→Client | `{}` | 辩论结束 |
| `judge:scoring` | Server→Client | `{status: 'analyzing'}` | 裁判评分中 |
| `judge:result` | Server→Client | `{report}` | 评分结果 |

### 10.5 数据模型

```typescript
// 辩题
interface Topic {
  id: string;
  title: string;           // 辩题标题
  proPosition: string;     // 正方立场
  conPosition: string;     // 反方立场
  category: string;        // 分类
  difficulty: 'easy' | 'medium' | 'hard';
  background?: string;     // 背景资料
  keyPoints?: string[];    // 关键论点提示
}

// 辩论会话
interface Debate {
  id: string;
  topicId: string;
  userId: string;
  userStance: 'pro' | 'con';     // 用户立场
  aiStance: 'pro' | 'con';       // AI 立场
  difficulty: 'beginner' | 'intermediate' | 'expert';
  status: 'preparing' | 'ongoing' | 'scoring' | 'completed';
  stages: DebateStage[];          // 各环节记录
  config: DebateConfig;           // 赛制配置
  startTime: Date;
  endTime?: Date;
  report?: JudgeReport;           // 评分报告
}

// 辩论环节
interface DebateStage {
  type: 'opening_pro' | 'opening_con' | 'cross_pro' | 'cross_con' | 'free_debate' | 'closing_con' | 'closing_pro';
  displayName: string;
  speaker: 'user' | 'ai' | 'both';
  timeLimit: number;              // 秒
  messages: Message[];            // 发言记录
  actualDuration: number;         // 实际用时（秒）
}

// 发言消息
interface Message {
  id: string;
  speaker: 'user' | 'ai';
  content: string;                // 文字内容
  timestamp: Date;
  duration: number;               // 发言时长（秒）
  inputMethod: 'voice' | 'text';  // 输入方式
}

// 赛制配置
interface DebateConfig {
  openingTime: number;        // 开篇立论时间（秒）
  crossExamTime: number;      // 质询时间（秒）
  freeDebateTime: number;     // 自由辩论每方时间（秒）
  closingTime: number;        // 总结陈词时间（秒）
  prepTime: number;           // 准备时间（秒）
  enablePreparation: boolean; // 是否启用赛前准备
}

// 评分报告
interface JudgeReport {
  winner: 'user' | 'ai';
  userScore: ScoreDetail;
  aiScore: ScoreDetail;
  overallComment: string;
  userHighlights: string[];
  userImprovements: string[];
  stageComments: Record<string, string>;
  keyMoments: KeyMoment[];
}

// 得分详情
interface ScoreDetail {
  total: number;
  argumentQuality: number;    // 论点质量 /25
  logic: number;              // 逻辑严密性 /25
  rebuttal: number;           // 反驳能力 /20
  evidence: number;           // 论据支撑 /15
  expression: number;         // 表达与风度 /15
}
```

---

## 11. 非功能性需求

### 11.1 性能需求

| 指标 | 要求 |
|------|------|
| 页面首次加载时间 | < 3 秒 |
| 语音识别延迟 | < 500ms |
| AI 首字回复延迟 | < 2 秒 |
| TTS 首音延迟 | < 1 秒 |
| WebSocket 消息延迟 | < 100ms |
| 并发辩论会话 | ≥ 50 场 |

### 11.2 可用性需求

- 系统可用性 ≥ 99.5%
- 支持辩论中断后恢复（断线重连）
- 关键数据持久化，防止丢失

### 11.3 兼容性需求

| 平台 | 支持 |
|------|------|
| Chrome 90+ | ✅ 完全支持 |
| Edge 90+ | ✅ 完全支持 |
| Firefox 90+ | ✅ 完全支持（Web Speech API 部分功能需降级） |
| Safari 15+ | ⚠️ 部分支持（语音功能受限） |
| 移动端浏览器 | ⚠️ 基本功能可用，语音体验待优化 |

### 11.4 安全性需求

- API 密钥通过后端代理调用，不暴露到前端
- 用户语音数据传输使用 HTTPS/WSS 加密
- 不长期存储用户语音原始文件
- 辩论记录可由用户自行删除

### 11.5 成本估算（单场辩论）

| 项目 | 估算费用 | 说明 |
|------|----------|------|
| AI 辩手 Token | ¥0.5 - ¥2.0 | 取决于辩论长度和模型选择 |
| AI 裁判 Token | ¥0.3 - ¥1.0 | 一次性评分调用 |
| 语音识别 | ¥0.1 - ¥0.5 | 约 15-20 分钟语音 |
| 语音合成 | ¥0.1 - ¥0.3 | AI 发言约 10 分钟 |
| **单场总计** | **¥1.0 - ¥3.8** | — |

---

## 12. 开发里程碑

### Phase 1：MVP（最小可行产品）— 2-3 周

**目标**：完成核心辩论流程（文字版）

- [ ] 项目工程搭建（前端 + 后端）
- [ ] 辩题选择页面（预置 20 个辩题）
- [ ] 辩论主界面基础布局
- [ ] 辩论引擎核心逻辑（环节流转、计时）
- [ ] AI 辩手接入（文字对话）
- [ ] 基础文字输入交互
- [ ] AI 裁判评分（基础版）
- [ ] 简单评分报告页面

### Phase 2：语音能力 — 1-2 周

**目标**：加入语音交互能力

- [ ] 语音识别（STT）接入
- [ ] 语音合成（TTS）接入
- [ ] 语音录制组件
- [ ] AI 语音播放组件
- [ ] 语音/文字切换
- [ ] 流式语音体验优化

### Phase 3：体验优化 — 1-2 周

**目标**：完善细节，提升体验

- [ ] UI/UX 打磨（动画、过渡效果）
- [ ] 评分报告可视化（雷达图、分数条）
- [ ] 难度等级系统
- [ ] 辩题库扩展（100+ 辩题）
- [ ] 辩论记录查看
- [ ] 暗色主题
- [ ] 响应式适配

### Phase 4：增强功能 — 2-3 周

**目标**：增加高级功能

- [ ] 用户系统（注册/登录）
- [ ] 辩论历史和统计
- [ ] 评分报告导出（PDF）
- [ ] 分享功能
- [ ] 赛制自定义配置
- [ ] AI 辩手风格选择
- [ ] 移动端体验优化

---

## 13. 风险与应对

| 风险 | 影响 | 概率 | 应对方案 |
|------|------|------|----------|
| AI 生成内容质量不稳定 | 辩论体验差 | 中 | 精心设计 Prompt、多轮测试优化、设置内容过滤 |
| 语音识别准确率不足 | 辩论内容有误 | 中 | 选用优质 STT 服务、支持手动纠错、提供文字备选 |
| API 调用延迟高 | 辩论节奏受影响 | 中 | 流式输出、预生成策略、多服务商备选 |
| API 调用成本超预期 | 运营成本高 | 中 | 监控用量、设置限额、选用性价比更高的模型 |
| 浏览器语音 API 兼容性 | 部分用户无法使用 | 高 | 提供文字输入兜底、明确浏览器要求 |
| 大模型输出不当内容 | 用户体验差/合规风险 | 低 | 内容过滤、Prompt 约束、监控告警 |
| 网络不稳定 | 辩论中断 | 中 | 断线重连机制、本地暂存、状态恢复 |

---

## 14. 附录

---

## 15. 交互与视觉升级规范

### 15.1 配色方案（60-30-10）

- **主色（60%）**：Base 系列（#0c0a09 ~ #e7e5e4）
- **辅助色（30%）**：Accent 系列（#729c72 ~ #263526）
- **强调色（10%）**：Primary 系列（#d0a06e ~ #65382b）

### 15.2 动画与交互参数

- 悬停缩放：1.02（卡片、按钮、导航链接）
- 过渡时长：300-500ms（页面切换与交互过渡）
- 动画曲线：cubic-bezier(0.16, 1, 0.3, 1)
- 触发方式：
  - Scroll reveal：IntersectionObserver + data-reveal
  - 视差：data-parallax + requestAnimationFrame

### 15.3 交互规范

- 可点击元素统一使用 `interactive-hover` 交互类
- 表单输入统一使用 `input-base` 焦点状态
- Loading 使用 skeleton 动效与轻量进度条

---

## 16. 性能测试与兼容性报告

### 16.1 性能测试（Lighthouse）

- 目标：交互评分 ≥ 90
- 执行命令建议：
  - `npx lighthouse http://localhost:3000 --chrome-flags="--headless"`
- 结果：待在本地 Chrome 环境执行后记录

### 16.2 构建验证

- `npm run build` 通过
- 构建警告：主包体积超过 500kB（建议后续做代码分割）

### 16.3 可用性测试（手工检查）

- 交互响应延迟 ≤ 100ms（按钮、输入、弹窗）
- 动画无明显卡顿，滚动视差平滑
- 表单焦点状态明显、可辨识

### 16.4 兼容性验证建议

- Chrome / Edge / Safari / Firefox 最新版本
- 移动端：iOS Safari 与 Android Chrome

---

## 17. 演示与交付物说明

- 在线演示：`http://localhost:3000/`
- 样式与交互代码：`src/index.css` 与各页面组件
- 交互与视觉规范：第 15 节
- 性能与兼容性报告：第 16 节

### 14.1 预置辩题示例

| 分类 | 辩题 | 正方 | 反方 |
|------|------|------|------|
| 科技 | 科技发展利弊 | 科技发展利大于弊 | 科技发展弊大于利 |
| 科技 | AI 与就业 | 人工智能会创造更多就业机会 | 人工智能会导致大规模失业 |
| 教育 | 应试教育 | 应试教育利大于弊 | 应试教育弊大于利 |
| 教育 | 大学必要性 | 上大学对个人发展是必要的 | 上大学对个人发展不是必要的 |
| 社会 | 网络实名制 | 网络应该实行实名制 | 网络不应该实行实名制 |
| 社会 | 城市 vs 农村 | 城市生活更幸福 | 农村生活更幸福 |
| 伦理 | 安乐死 | 应该合法化安乐死 | 不应该合法化安乐死 |
| 伦理 | 隐私与安全 | 个人隐私比公共安全更重要 | 公共安全比个人隐私更重要 |
| 文化 | 传统 vs 现代 | 传统文化在现代社会仍有重要价值 | 现代文化比传统文化更适合当今社会 |
| 生活 | 金钱 vs 理想 | 选择工作时薪资比理想更重要 | 选择工作时理想比薪资更重要 |

### 14.2 辩论术语表

| 术语 | 说明 |
|------|------|
| 立论 | 阐述本方基本观点和论证框架 |
| 质询/攻辩 | 向对方提问，揭示对方观点中的问题 |
| 反驳 | 针对对方的论点进行批驳 |
| 自由辩论 | 双方自由发言、交锋的环节 |
| 总结陈词 | 对全场辩论进行总结，做最后的陈述 |
| 论点 | 辩论中提出的观点 |
| 论据 | 用来支持论点的事实、数据、案例 |
| 论证 | 用论据证明论点的过程 |

### 14.3 参考资源

- 国际辩论赛规则（WSDC/BP 赛制）
- 华语辩论世界杯赛制规则
- Web Speech API 文档
- Azure Cognitive Services 文档
- 豆包（Doubao）API 文档
- DeepSeek API 文档

---

> **文档版本记录**
>
> | 版本 | 日期 | 修改人 | 修改内容 |
> |------|------|--------|----------|
> | v1.0 | 2026-02-07 | AI | 初始版本，完成全部章节 |
> | v1.1 | 2026-02-07 | AI | 更新AI模型方案：AI辩手改为豆包（Doubao），AI裁判改为DeepSeek |
